Functions used in the main program
